import os
import yara


class YaraScanner:
    def __init__(self):
        # Create the list of rules
        self.yara_rules = os.listdir('malwareconfig/yaraRules/')
        self.rule_file = 'malwareconfig/yaraRules/yaraRules.yar'
        self.compiled_rules = yara.compile(self.rule_file)
        self.rule_list = []

    # Yara Scanner Returns the Rule Name
    def yara_scan(self, raw_data):
        matches = self.compiled_rules.match(data=raw_data)
        rule_list = []

        for match in matches:
            rule_list.append(match.rule)
        self.rule_list = rule_list
