from malwareconfig import crypto
from malwareconfig.common import Decoder
from malwareconfig.common import string_printable


class NanoCore(Decoder):
    decoder_name = "NanoCore"
    decoder__version = 1
    decoder_author = "@kevthehermit"
    decoder_description = "NanoCre decoder for early versions"

    def __init__(self):
        self.config = {}

    def get_config(self):
        '''
        This is the main entry
        :return:
        '''

        file_data = self.file_info.file_data

        # Version Check
        #dc_version = self.get_version(file_data)

        #resources = self.file_info.dotnet_resource('meh')

        #self.file_info.get_pe_resource_by_name('meh')

        user_strings = self.file_info.dotnet_user_strings()

        print(user_strings)

        ## WORKING
        #guids = self.file_info.dotnet_guids()


        raw_config = {}

        # Set the config to the class for use
        self.config = raw_config
